# Test info

- Name: Task Management >> should show warning if task input exceeds 20 characters
- Location: /tests/playwright/tests/task.spec.js:53:3

# Error details

```
Error: locator.click: Test timeout of 30000ms exceeded.
Call log:
  - waiting for locator('#task-list .btn-danger').nth(1)
    - locator resolved to <button aria-label="Delete task Second Task" class="btn btn-sm btn-danger btn-delete-task" data-id="3d5e1385-4d53-424b-9f26-1ef20594b0d0">x</button>
  - attempting click action
    - waiting for element to be visible, enabled and stable
  - element was detached from the DOM, retrying

    at /tests/playwright/tests/task.spec.js:18:34
```

# Page snapshot

```yaml
- heading "Task Manager" [level=1]
- textbox "New task..."
- button "Add Task"
- button "Remove All"
- list:
  - listitem:
    - text: Second Task
    - button "Delete task Second Task": x
```

# Test source

```ts
   1 | const { test, expect } = require('@playwright/test');
   2 |
   3 | test.describe('Task Management', () => {
   4 |   test.beforeEach(async ({ page }) => {
   5 |     const baseUrl = process.env.BASE_URL || 'http://localhost:3000';
   6 |     await page.goto(baseUrl, { waitUntil: 'load' });
   7 |
   8 |     // Wait for the main heading to confirm page has loaded
   9 |     await expect(page.locator('h1')).toHaveText('Task Manager', { timeout: 5000 });
  10 |
  11 |     // Optional: capture a screenshot for debugging
  12 |     await page.screenshot({ path: 'debug.png', fullPage: true });
  13 |
  14 |     // Attempt to delete any existing tasks
  15 |     const deleteButtons = await page.locator('#task-list .btn-danger');
  16 |     const count = await deleteButtons.count();
  17 |     for (let i = 0; i < count; i++) {
> 18 |       await deleteButtons.nth(i).click();
     |                                  ^ Error: locator.click: Test timeout of 30000ms exceeded.
  19 |     }
  20 |   });
  21 |
  22 |   test('should add a task', async ({ page }) => {
  23 |     await page.fill('#task-input', 'Test Playwright Task');
  24 |     await page.click('text=Add Task');
  25 |     await expect(page.locator('#task-list')).toContainText('Test Playwright Task');
  26 |   });
  27 |
  28 |   test('should clear the input after adding a task', async ({ page }) => {
  29 |     const input = page.locator('#task-input');
  30 |     await input.fill('Another CI Test Task');
  31 |     await page.click('text=Add Task');
  32 |
  33 |     await expect(page.locator('#task-list')).toContainText('Another CI Test Task');
  34 |     await expect(input).toHaveValue('');
  35 |   });
  36 |
  37 |   test('should not add a task if input is empty', async ({ page }) => {
  38 |     await page.fill('#task-input', '');
  39 |     await page.click('text=Add Task');
  40 |     await expect(page.locator('#form-warning')).toBeVisible({ timeout: 2000 });
  41 |     await expect(page.locator('#form-warning')).toHaveText('Task title cannot be empty.');
  42 |   });
  43 |
  44 |   test('should allow adding multiple tasks', async ({ page }) => {
  45 |     await page.fill('#task-input', 'First Task');
  46 |     await page.click('text=Add Task');
  47 |     await page.fill('#task-input', 'Second Task');
  48 |     await page.click('text=Add Task');
  49 |     await expect(page.locator('#task-list')).toContainText('First Task');
  50 |     await expect(page.locator('#task-list')).toContainText('Second Task');
  51 |   });
  52 |
  53 |   test('should show warning if task input exceeds 20 characters', async ({ page }) => {
  54 |     const input = page.locator('#task-input');
  55 |     const warning = page.locator('#form-warning');
  56 |     const longText = 'A'.repeat(21);
  57 |
  58 |     await input.fill(''); // Ensure empty first
  59 |     await expect(input).toHaveValue('');
  60 |
  61 |     await input.fill(longText); // Fill input with more than 20 characters (should not be allowed to add task)
  62 |     await expect(warning).toBeHidden(); // Still no warning
  63 |
  64 |     await page.click('text=Add Task'); // Try to submit
  65 |     await expect(warning).toBeVisible({ timeout: 3000 }); // Now warning should appear
  66 |     await expect(warning).toHaveText('Task title must be 20 characters or less.');
  67 |
  68 |     const taskTexts = await page.locator('#task-list li').allTextContents();
  69 |     expect(taskTexts.some(text => text.includes(longText))).toBeFalsy(); // Confirm task wasn't added
  70 |   });
  71 |   test('should assign a UUID to new tasks', async ({ page }) => {
  72 |     await page.fill('#task-input', 'UUID Test');
  73 |     await page.click('text=Add Task');
  74 |
  75 |     const deleteButtons = await page.locator('#task-list .btn-danger');
  76 |     const dataId = await deleteButtons.first().getAttribute('data-id');
  77 |     expect(dataId).toMatch(/^[\da-f]{8}-([\da-f]{4}-){3}[\da-f]{12}$/i);
  78 |   });
  79 |
  80 |   test('should delete a task', async ({ page }) => {
  81 |     await page.fill('#task-input', 'Task to be deleted');
  82 |     await page.click('text=Add Task');
  83 |
  84 |     const taskLocator = page.locator('#task-list li', { hasText: 'Task to be deleted' });
  85 |     await expect(taskLocator).toBeVisible();
  86 |
  87 |     const deleteButton = taskLocator.locator('.btn-danger');
  88 |     await deleteButton.click();
  89 |
  90 |     await expect(taskLocator).not.toBeVisible();
  91 |   });
  92 | });
  93 |
```